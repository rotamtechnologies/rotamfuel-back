require('../models/KeyCloakCliente');
require("../util/Utils")
global.obtenerToken = (req, res) => {
    try {
        let user = req.body.user;
        let pass = req.body.pass;
        keyCloakClient.obtenerToken(user, pass).then(tokens => {
            tokens = JSON.parse(tokens);
            if (tokens.access_token) {
                JSONResponse.OK(res, {tkn: tokens.access_token, rsh: tokens.refresh_token})
            } else {
                JSONResponse.ERROR(res, tokens)
            }
        })
    } catch (e) {
        JSONResponse.ERROR(res)

    }

};
global.refrescarToken = (req, res) => {
    try {

        let token = tokenByReq(req,res);
        keyCloakClient.refrescarToken(token).then(tokens => {
            tokens = JSON.parse(tokens);
            if (tokens.access_token) {
                console.log(tokens)
                JSONResponse.OK(res, {tkn: tokens.access_token, rsh: tokens.refresh_token})
            } else {
                JSONResponse.ERROR(res, tokens)
            }
        })
    } catch (e) {
        JSONResponse.ERROR(res)

    }
}
